# Jira Auto-Close Bot

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞—Ç–≤–∞—Ä—è Jira —Ç–∏–∫–µ—Ç–∏, –∫–æ–∏—Ç–æ —Å–∞ –≤ —Å—Ç–∞—Ç—É—Å "Waiting for Customer" –ø–æ–≤–µ—á–µ –æ—Ç 5 —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏ (–±–µ–∑ —Å—ä–±–æ—Ç–∞ –∏ –Ω–µ–¥–µ–ª—è).

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç

- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–≤–∞ —Ç–∏–∫–µ—Ç–∏ –≤ "Waiting for customer" —Å—Ç–∞—Ç—É—Å
- ‚úÖ –ò–∑—á–∏—Å–ª—è–≤–∞ —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏ (–±–µ–∑ —Å—ä–±–æ—Ç–∞ –∏ –Ω–µ–¥–µ–ª—è)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ assign-–≤–∞ —Ç–∏–∫–µ—Ç–∞ –Ω–∞ –±–æ—Ç –∞–∫–∞—É–Ω—Ç–∞
- ‚úÖ –ó–∞—Ç–≤–∞—Ä—è —Ç–∏–∫–µ—Ç–∏ —Å–ª–µ–¥ 5+ —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏
- ‚úÖ –î–æ–±–∞–≤—è –∫–æ–º–µ–Ω—Ç–∞—Ä —Å –æ–±—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–∏ –∑–∞—Ç–≤–∞—Ä—è–Ω–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞ –≤—Å–µ–∫–∏ —Ä–∞–±–æ—Ç–µ–Ω –¥–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)
- ‚úÖ Robust error handling - –Ω–µ —Å–ø–∏—Ä–∞ –ø—Ä–∏ –≥—Ä–µ—à–∫–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—ä–∑–¥–∞–≤–∞ Bug —Ç–∏–∫–µ—Ç –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω–∏ –≥—Ä–µ—à–∫–∏
- ‚úÖ –ó–∞–ø–∏—Å–≤–∞ –ª–æ–≥–æ–≤–µ –≤ `log/bot_log.txt`

## üõ°Ô∏è Error Handling & Robustness

–ë–æ—Ç—ä—Ç –µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–∞–Ω –¥–∞ —Ä–∞–±–æ—Ç–∏ –Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–æ –±–µ–∑ —á–æ–≤–µ—à–∫–∞ –Ω–∞–º–µ—Å–∞:

- **–£—Å—Ç–æ–π—á–∏–≤ –Ω–∞ –≥—Ä–µ—à–∫–∏:** –ê–∫–æ –∏–º–∞ –ø—Ä–æ–±–ª–µ–º —Å –µ–¥–∏–Ω —Ç–∏–∫–µ—Ç, –ø—Ä–µ—Å–∫–∞—á–∞ –≥–æ –∏ –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞ —Å –æ—Å—Ç–∞–Ω–∞–ª–∏—Ç–µ
- **–ù–µ —Å–ø–∏—Ä–∞ —Ä–∞–±–æ—Ç–∞:** –ü—Ä–∏ –≥—Ä–µ—à–∫–∞ –ø–æ–∫–∞–∑–≤–∞ –¥–µ—Ç–∞–π–ª–∏, –Ω–æ –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞ –Ω–∞ —Å–ª–µ–¥–≤–∞—â–æ—Ç–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —É–≤–µ–¥–æ–º—è–≤–∞–Ω–µ:** –ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞ –≥—Ä–µ—à–∫–∞ —Å—ä–∑–¥–∞–≤–∞ Bug —Ç–∏–∫–µ—Ç –≤ Jira –∑–∞ investigation
- **–ü–æ–¥—Ä–æ–±–Ω–æ –ª–æ–≥–≤–∞–Ω–µ:** –í—Å–∏—á–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –≥—Ä–µ—à–∫–∏ —Å–µ –∑–∞–ø–∏—Å–≤–∞—Ç –≤ log —Ñ–∞–π–ª
- **Graceful degradation:** 
  - –ê–∫–æ assign-–≤–∞–Ω–µ—Ç–æ —Ñ–µ–π–ª–Ω–µ ‚Üí –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞ —Å—ä—Å –∑–∞—Ç–≤–∞—Ä—è–Ω–µ—Ç–æ
  - –ê–∫–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—ä—Ç —Ñ–µ–π–ª–Ω–µ ‚Üí –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞ —Å—ä—Å –∑–∞—Ç–≤–∞—Ä—è–Ω–µ—Ç–æ
  - –ê–∫–æ –∑–∞—Ç–≤–∞—Ä—è–Ω–µ—Ç–æ —Ñ–µ–π–ª–Ω–µ –Ω–∞ –µ–¥–∏–Ω —Ç–∏–∫–µ—Ç ‚Üí –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞ —Å—ä—Å —Å–ª–µ–¥–≤–∞—â–∏—è

## –ò–∑–∏—Å–∫–≤–∞–Ω–∏—è

- Python 3.7+
- Jira –∞–∫–∞—É–Ω—Ç –∑–∞ –±–æ—Ç–∞ —Å –ø—Ä–∞–≤–∞:
  - Browse Projects
  - Assignable User
  - Close Issues
  - Add Comments
  - Transition Issues

## –ò–Ω—Å—Ç–∞–ª–∞—Ü–∏—è

### 1. –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–π—Ç–µ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 2. –°—ä–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–µ–Ω —Ñ–∞–π–ª

–ö–æ–ø–∏—Ä–∞–π—Ç–µ `config.json.example` –∫—ä–º `config.json`:

```bash
copy config.json.example config.json
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–π—Ç–µ –±–æ—Ç–∞

–†–µ–¥–∞–∫—Ç–∏—Ä–∞–π—Ç–µ `config.json` –∏ –ø–æ–ø—ä–ª–Ω–µ—Ç–µ:

```json
{
  "jira_url": "https://yourcompany.atlassian.net",
  "username": "bot@yourcompany.com",
  "api_token": "YOUR_API_TOKEN_HERE",
  "days_threshold": 5,
  "dry_run": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `jira_url`: URL –Ω–∞ –≤–∞—à–∞—Ç–∞ Jira –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è
- `username`: Email –Ω–∞ –±–æ—Ç –∞–∫–∞—É–Ω—Ç–∞
- `api_token`: API —Ç–æ–∫–µ–Ω (–≥–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ –æ—Ç: https://id.atlassian.com/manage-profile/security/api-tokens)
- `days_threshold`: –ë—Ä–æ–π —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏ –ø—Ä–µ–¥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞—Ç–≤–∞—Ä—è–Ω–µ (–ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ: 5)
- `dry_run`: –ê–∫–æ –µ `true`, —Å–∞–º–æ –ø–æ–∫–∞–∑–≤–∞ —Ç–∏–∫–µ—Ç–∏—Ç–µ –±–µ–∑ –¥–∞ –≥–∏ –∑–∞—Ç–≤–∞—Ä—è (–∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ)

## –£–ø–æ—Ç—Ä–µ–±–∞

### –†—ä—á–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ

```bash
python jira_auto_close.py
```

### –¢–µ—Å—Ç–æ–≤ —Ä–µ–∂–∏–º (Dry Run)

–ó–∞ –¥–∞ –≤–∏–¥–∏—Ç–µ –∫–æ–∏ —Ç–∏–∫–µ—Ç–∏ —â–µ –±—ä–¥–∞—Ç –∑–∞—Ç–≤–æ—Ä–µ–Ω–∏ –±–µ–∑ –¥–∞ –≥–∏ –∑–∞—Ç–≤–∞—Ä—è—Ç–µ —Ä–µ–∞–ª–Ω–æ:

–ü—Ä–æ–º–µ–Ω–µ—Ç–µ –≤ `config.json`:
```json
"dry_run": true
```

–°–ª–µ–¥ —Ç–æ–≤–∞:
```bash
python jira_auto_close.py
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ

#### Windows Task Scheduler

1. –û—Ç–≤–æ—Ä–µ—Ç–µ Task Scheduler
2. –°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤–∞ –∑–∞–¥–∞—á–∞ (Create Task)
3. General —Ç–∞–±:
   - Name: "Jira Auto-Close Bot"
   - Run whether user is logged on or not
4. Triggers —Ç–∞–±:
   - New Trigger
   - Daily, every 1 day
   - Start time: 09:00 (–∏–ª–∏ –ø–æ –≤–∞—à –∏–∑–±–æ—Ä)
   - Enabled
5. Actions —Ç–∞–±:
   - New Action
   - Program/script: `python.exe` (–∏–ª–∏ –ø—ä–ª–µ–Ω –ø—ä—Ç –¥–æ python)
   - Add arguments: `jira_auto_close.py`
   - Start in: `C:\Users\OGS\Desktop\bot` (–ø—ä—Ç—è –¥–æ –±–æ—Ç–∞)
6. Conditions —Ç–∞–±:
   - –ü—Ä–µ–º–∞—Ö–Ω–µ—Ç–µ "Start the task only if the computer is on AC power"

#### –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –≤–∫–ª—é—á–µ–Ω–∏—è scheduler script

–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ PowerShell —Å–∫—Ä–∏–ø—Ç–∞:

```powershell
.\run_daily.ps1
```

–ó–∞ –¥–∞ –¥–æ–±–∞–≤–∏—Ç–µ –∫—ä–º Task Scheduler:
```powershell
.\setup_scheduler.ps1
```

## –ü—Ä–∏–º–µ—Ä–µ–Ω –∏–∑—Ö–æ–¥

```
============================================================
Jira Auto-Close Bot - Starting...
Date: 2026-01-15 09:00:00
Threshold: 5 working days
Mode: LIVE
============================================================
Searching for tickets with status: Waiting for Customer
Ticket PROJ-123: 7 working days in Waiting for Customer
Ticket PROJ-456: 6 working days in Waiting for Customer

Found 2 ticket(s) to close:
  - PROJ-123: Customer not responding to email request
    Status changed: 2026-01-03
    Working days: 7
  - PROJ-456: Waiting for customer feedback
    Status changed: 2026-01-06
    Working days: 6

Closing tickets...
Assigning PROJ-123 to bot account...
Closing ticket PROJ-123...
‚úì Ticket PROJ-123 closed successfully
Assigning PROJ-456 to bot account...
Closing ticket PROJ-456...
‚úì Ticket PROJ-456 closed successfully

============================================================
Summary: Closed 2 out of 2 ticket(s)
============================================================
```

## –°–∏–≥—É—Ä–Ω–æ—Å—Ç

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –ù–∏–∫–æ–≥–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–≤–∞–π—Ç–µ `config.json` —Å —Ä–µ–∞–ª–Ω–∏ credentials!

- `config.json` –µ –¥–æ–±–∞–≤–µ–Ω –≤ `.gitignore`
- –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Å–∞–º–æ `config.json.example` –∑–∞ —Å–ø–æ–¥–µ–ª—è–Ω–µ
- API —Ç–æ–∫–µ–Ω–∏—Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –ø–∞–∑—è—Ç –≤ —Ç–∞–π–Ω–∞

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º: "Could not find close transition"

–í–∞—à–∏—è—Ç Jira workflow –º–æ–∂–µ –¥–∞ –∏–º–∞ —Ä–∞–∑–ª–∏—á–Ω–æ –∏–º–µ –Ω–∞ –∑–∞—Ç–≤–∞—Ä—è—â–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–æ—Å—Ç—ä–ø–Ω–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –∏–∑—Ö–æ–¥–∞ –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–π—Ç–µ –∫–æ–¥–∞ –∞–∫–æ –µ –Ω—É–∂–Ω–æ.

### –ü—Ä–æ–±–ª–µ–º: "Authentication failed"

- –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ API —Ç–æ–∫–µ–Ω–∞ –µ –≤–∞–ª–∏–¥–µ–Ω
- –£–≤–µ—Ä–µ—Ç–µ —Å–µ, —á–µ username-–∞ –µ —Ç–æ—á–µ–Ω email –∞–¥—Ä–µ—Å
- –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ Jira URL –µ –ø—Ä–∞–≤–∏–ª–µ–Ω

### –ü—Ä–æ–±–ª–µ–º: "Permission denied"

–ë–æ—Ç –∞–∫–∞—É–Ω—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ —Å–ª–µ–¥–Ω–∏—Ç–µ –ø—Ä–∞–≤–∞:
- Browse Projects
- Assignable User  
- Close Issues
- Add Comments
- Transition Issues

## –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è

–ê–∫–æ —Å—Ç–∞—Ç—É—Å—ä—Ç –≤—ä–≤ –≤–∞—à–∞—Ç–∞ Jira –µ —Ä–∞–∑–ª–∏—á–µ–Ω –æ—Ç "Waiting for Customer", –º–æ–∂–µ—Ç–µ –¥–∞ –≥–æ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ –≤ –∫–æ–¥–∞:

```python
tickets_to_close = self.find_old_waiting_tickets(
    days_threshold=5, 
    status_name="–í–∞—à–∏—è –°—Ç–∞—Ç—É—Å"
)
```

## –õ–∏—Ü–µ–Ω–∑

MIT
